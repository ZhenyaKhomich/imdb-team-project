import{a as H}from"./chunk-TRPPY4LF.js";import{a as $}from"./chunk-Y4OVPVXT.js";import{b as R,c as D,e as p,g as M,h as P,k as G,m as L,n as B,o as q,q as O}from"./chunk-FMRYYTNH.js";import{t as z,v as j}from"./chunk-A4OJEWE2.js";import{a as Z}from"./chunk-JMU6WUS3.js";import{a as T,b as V}from"./chunk-O3XRZV7M.js";import"./chunk-EQKMLW76.js";import{Gb as y,Ja as E,Pa as v,S as u,Ta as d,W as F,X as w,Za as S,bc as N,cb as i,db as r,eb as _,ib as k,kb as U,sc as A,tc as I,yb as s,za as o}from"./chunk-U6YJBN55.js";var b=n=>({"border-color":n});function K(n,m){n&1&&(i(0,"div",7),s(1,"Enter a valid English name consisting of a capital letter and at least 2 letters"),r())}function Q(n,m){n&1&&(i(0,"div",7),s(1,"Enter the correct E-mail address"),r())}function W(n,m){n&1&&(i(0,"div",7),s(1,"Enter password containing at least 7 digits and 1 uppercase English letter"),r())}function X(n,m){n&1&&(i(0,"div",7),s(1,"Accept the terms of the confidentiality policy"),r())}var J=class n{showPasswordValue=!1;signUpForm;AppRoutesEnum=Z;fb=u(q);authService=u(H);snakeBar=u(j);localStorageService=u($);router=u(A);signalService=u(z);ngOnInit(){this.signUpForm=this.fb.group({name:["",[p.required,p.pattern("^([A-Z][a-z]+)(\\s[A-Z][a-z]+)*$")]],email:["",[p.required,p.email]],password:["",[p.required,p.pattern("^(?=.*[A-Z])(?=.*\\d)[A-Za-z\\d]{8,}$")]],rules:[!1,p.requiredTrue]})}showPassword(){this.showPasswordValue=!this.showPasswordValue}signup(){if(this.signUpForm.valid){let m={name:this.signUpForm.value.name,email:this.signUpForm.value.email,password:this.signUpForm.value.password};this.authService.signup(m).subscribe({next:l=>{if(l.accessToken&&l.refreshToken&&l.userId){let e={email:this.signUpForm.value.email,password:this.signUpForm.value.password,rememberMe:!1};this.authService.login(e).subscribe({next:t=>{t.accessToken&&t.refreshToken&&t.userId&&(this.snakeBar.open("Registration was successful","",{duration:4e3}),this.localStorageService.setTokens(t),this.router.navigate([""]),this.signalService.isLogin.set(!0),this.signUpForm.reset(),this.authService.getUser().subscribe(a=>{this.signalService.userData.set(a)}))},error:t=>{this.snakeBar.open(t.error.message,"",{duration:4e3})}})}},error:l=>{this.snakeBar.open(l.error.message,"",{duration:4e3})}})}else this.signUpForm.markAllAsTouched()}static \u0275fac=function(l){return new(l||n)};static \u0275cmp=E({type:n,selectors:[["app-signup"]],decls:25,vars:17,consts:[["name",""],[1,"auth"],[1,"container"],[1,"auth-form",3,"formGroup"],[1,"auth-form-title"],[1,"inputs"],["type","text","formControlName","name","placeholder","Name",1,"input",3,"ngStyle"],[1,"error"],["type","text","formControlName","email","placeholder","Email",1,"input",3,"ngStyle"],["formControlName","password","placeholder","Password",1,"input",3,"type","ngStyle"],[1,"signup__eye",3,"click","fontIcon"],["type","checkbox","formControlName","rules",1,"auth-form-conditions"],[1,"auth-form-conditions-text"],[1,"btn","auth-form-button",3,"click"],[1,"auth-question"],[3,"routerLink"]],template:function(l,e){if(l&1){let t=k();i(0,"section",1)(1,"div",2)(2,"form",3)(3,"div",4),s(4,"Registration on the website"),r(),i(5,"div",5),_(6,"input",6,0),v(8,K,2,0,"div",7),_(9,"input",8),v(10,Q,2,0,"div",7),_(11,"input",9),i(12,"mat-icon",10),U("click",function(){return F(t),w(e.showPassword())}),r(),v(13,W,2,0,"div",7),i(14,"label"),_(15,"input",11),i(16,"div",12),s(17," I accept the terms of the user agreement and consent to the processing of personal data. "),r()(),v(18,X,2,0,"div",7),r(),i(19,"button",13),U("click",function(){return F(t),w(e.signup())}),s(20,"Sign Up"),r(),i(21,"div",14),s(22," Do you already have an account? "),i(23,"a",15),s(24,"Log In"),r()()()()()}if(l&2){let t,a,c,g,h,f,C;o(2),d("formGroup",e.signUpForm),o(4),d("ngStyle",y(11,b,(t=e.signUpForm.get("name"))!=null&&t.invalid&&((t=e.signUpForm.get("name"))!=null&&t.touched||(t=e.signUpForm.get("name"))!=null&&t.dirty)?"red":"")),o(2),S((a=e.signUpForm.get("name"))!=null&&a.invalid&&((a=e.signUpForm.get("name"))!=null&&a.touched||(a=e.signUpForm.get("name"))!=null&&a.dirty)?8:-1),o(),d("ngStyle",y(13,b,(c=e.signUpForm.get("email"))!=null&&c.invalid&&((c=e.signUpForm.get("email"))!=null&&c.touched||(c=e.signUpForm.get("email"))!=null&&c.dirty)?"red":"")),o(),S((g=e.signUpForm.get("email"))!=null&&g.invalid&&((g=e.signUpForm.get("email"))!=null&&g.touched||(g=e.signUpForm.get("email"))!=null&&g.dirty)?10:-1),o(),d("type",e.showPasswordValue?"text":"password")("ngStyle",y(15,b,(h=e.signUpForm.get("password"))!=null&&h.invalid&&((h=e.signUpForm.get("password"))!=null&&h.touched||(h=e.signUpForm.get("password"))!=null&&h.dirty)?"red":"")),o(),d("fontIcon",e.showPasswordValue?"visibility_off":"visibility"),o(),S((f=e.signUpForm.get("password"))!=null&&f.invalid&&((f=e.signUpForm.get("password"))!=null&&f.touched||(f=e.signUpForm.get("password"))!=null&&f.dirty)?13:-1),o(5),S(e.signUpForm.invalid&&((C=e.signUpForm.get("rules"))!=null&&C.touched)?18:-1),o(5),d("routerLink","/"+e.AppRoutesEnum.LOGIN)}},dependencies:[O,G,D,R,M,P,L,B,N,V,T,I],encapsulation:2,changeDetection:0})};export{J as SignupComponent};
